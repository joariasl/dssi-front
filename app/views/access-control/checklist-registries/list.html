<div class="x_title">
  <h2>Buscar Checklist</h2>
  <div class="clearfix"></div>
</div>
<div class="x_content">
  <div class="form-group">
    <div class="col-md-3 col-sm-6 col-xs-12" ng-model="criterio">
      <div class="input-group">
        <input type="text" class="form-control" placeholder="Buscar">
        <span class="input-group-btn">
          <button class="btn btn-primary" type="button"><i class="fa fa-search" aria-hidden="true"></i></button>
        </span>
      </div>
    </div>
    <!-- Filtrar -->
    <div class="col-md-2 col-sm-6 col-xs-12" class="dropdown dropup docs-options">
      <button type="button" class="btn btn-primary btn-block dropdown-toggle" data-toggle="dropdown" aria-expanded="true">Filtrar<span class="caret"></span></button>
      <ul class="dropdown-menu" aria-labelledby="toggleOptions" role="menu">
        <li role="presentation">
          <label class="checkbox-inline"><input type="checkbox" name="responsive" checked>Nombre</label>
        </li>
        <li role="presentation">
          <label class="checkbox-inline"><input type="checkbox" name="restore">Apellido</label>
        </li>
      </ul>
    </div>
    <!-- FIN Filtrar -->
  </div>
</div>
<div class="x_title">
  <h2>Últimos checklist</h2>
  <div class="clearfix"></div>
</div>
<div class="x_content">
  <div class="table-responsive">
    <table st-table="displayedChecklistsRegistries" st-safe-src="checklistRegistries.checklistsRegistries" class="table table-bordered">
      <thead>
        <tr class="headings">
          <th rowspan="3" >
            <input type="checkbox" class="flat">
          </th>
          <th st-sort="id" rowspan="2" class="text-center">N° Folio</th>
          <th st-sort="date" st-sort-default="reverse" rowspan="2" class="text-center">Fecha</th>
          <th rowspan="2" class="text-center">Turno</th>
          <th colspan="{{ checklistRegistries.checklistItemGroups.length + 1 }}" class="text-center">% Cumplimiento</th> <!--colspan segun cuantos grupos existan-->
          <th colspan="3" class="text-center">Credenciales</th>
          <th rowspan="2" class="text-center">Acción</th>
        </tr>
        <tr class="headings">
          <th ng-repeat="item_group in checklistRegistries.checklistItemGroups | orderBy : 'name'" class="text-center">{{ item_group.name }}</th> <!-- ng-repeat para sacar los grupos-->
          <!-- Total % cell -->
          <th>Total</th>
          <!-- Total % cell -->
          <th class="text-center">Entregadas</th>
          <th class="text-center">Disponibles</th>
          <th class="text-center">Total</th>
        </tr>
        <!-- Search -->
        <tr>
  				<th><input st-search="id" class="form-control" placeholder="Id" type="text"/></th>
          <th colspan="9"></th>
  			</tr>
      </thead>
      <tbody ng-show="checklistRegistries.checklistsRegistries.$promise.$$state.status">
        <tr ng-repeat="checklistRegistry in displayedChecklistsRegistries">
          <td><input type="checkbox" class="flat" name="table_records"></td>
          <td>{{ checklistRegistry.id }}</td>
          <td>{{ checklistRegistry.date | date }}</td>
          <td>{{ checklistRegistries.checklistTurns[checklistRegistry.turn-1].name }}</td>
          <td ng-repeat="item_group in checklistRegistries.checklistItemGroups | orderBy : 'name'">{{ 100 * checklistRegistry.total_groups[item_group.id].total_ok / checklistRegistry.total_groups[item_group.id].total | number : 0 }}%</td>
          <!-- Total % cell -->
          <td>{{ 100 * checklistRegistry.total_ok / checklistRegistry.checklist_entries.length | number : 0 }}%</td>
          <!-- /Total % cell -->
          <td>{{ checklistRegistry.credential_delivered }}</td>
          <td>{{ checklistRegistry.credential_avaliable }}</td>
          <td>{{ checklistRegistry.credential_delivered + checklistRegistry.credential_avaliable }}</td>
          <td class="text-center">
            <div class="btn-group">
              <a type="button" class="btn btn-default btn-xs" ui-sref="^.checklist-registry({id: checklistRegistry.id})">
                <span class="glyphicon glyphicon-eye-open" aria-hidden="true"></span>
              </a>
            </div>
          </td>
        </tr>
      </tbody>
      <tbody ng-show="checklistRegistries.checklistsRegistries.$promise.$$state.status === 0">
      	<tr>
  		    <td colspan="{{ 9 + checklistRegistries.checklistItemGroups.length }}" class="text-center">
            <i class="fa fa-refresh fa-spin fa-2x fa-fw" aria-hidden="true"></i>
          </td>
      	</tr>
    	</tbody>
      <tfoot>
  			<tr>
  				<td colspan="{{ 9 + checklistRegistries.checklistItemGroups.length }}" class="text-center">
  					<div st-pagination="" st-items-by-page="10" st-displayed-pages="7"></div>
  				</td>
  			</tr>
  		</tfoot>
    </table>
  </div>
</div>
